
@{
    ViewBag.Title = "NewAccessUserIDRequest";
}
<script src="~/Scripts/i18n/grid.locale-en.js"></script>
<link href="~/Content/themes/base/jquery-ui.css" rel="stylesheet" />
<link href="~/Content/jquery.jqGrid/ui.jqgrid.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.9.1.min.js"></script>
<script src="~/Scripts/jquery-ui-1.10.4.min.js"></script>
<script src="~/Scripts/jquery.jqGrid.min.js"></script>

@using (@Html.BeginForm(FormMethod.Post))
{
<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">USER REQUEST</h1>
    </div>
</div>
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                New Access & User ID Request
            </div>
            <div class="panel-body">
                <div class="row" style="margin-bottom:20px">
                    <div class="col-lg-12">
                        <form role="form">
                            <div class="form-group">
                               
                                @Html.Label("Form Number :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-10">
                                    @Html.Label("[Generated By System]", new { @class = "" })
                                    
                                </div>
                            </div>
                            <div class="form-group">
                                @Html.Label("Request Date :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-10">
                                    @Html.Label(@DateTime.Now.ToShortDateString(), new {  })
                                </div>
                            </div>
                            @if (@ViewBag.NIK != null)
                            {<div class="form-group">
                                @Html.Label("NIK :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-5">
                                    @Html.TextBox("pivchNIK", (String)@ViewBag.NIK, new { @class = "form-control", @readonly = "readonly" })
                                    @Html.Hidden("pivchJobId",(String)@ViewBag.Job)
                                </div>
                                <div class="col-lg-5">
                                    <a type="button" class="btn btn-default" data-toggle="modal" href="#myModal">Cek</a>
                                </div>
                            </div>
                                
                            }else
                            { 
                            <div class="form-group">
                                @Html.Label("NIK :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-5">
                                    @Html.TextBox("pivchNIK", null, new { @class = "form-control", @readonly = "readonly" })
                                </div>
                                <div class="col-lg-5">
                                    <a type="button" class="btn btn-default" data-toggle="modal" href="#myModal">Cek</a>
                                </div>
                            </div>
                            }
                            @if (@ViewBag.Name != null)
                            {
                                 <div class="form-group">
                                @Html.Label("Employee Name :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-10">
                                    @Html.Label((String)@ViewBag.Name, new { })
                                </div>
                            </div>
                            }
                            else
                            { 
                            <div class="form-group">
                                @Html.Label("Employee Name :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-10">
                                    @Html.Label("-", new { @class = "col-md-2 control-label" })
                                </div>
                            </div>
                            }
                            @if (@ViewBag.Branch != null)
                            {
                                <div class="form-group">
                                @Html.Label("Branch :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-10">
                                    @Html.Label((String)@ViewBag.Branch, new { })
                                </div>
                            </div>
                            }
                            else
                            { 
                            <div class="form-group">
                                @Html.Label("Branch :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-10">
                                    @Html.Label("-", new { @class = "col-md-2 control-label" })
                                </div>
                            </div>
                            }
                            @if (@ViewBag.Dept != null)
                            {
                                <div class="form-group">
                                @Html.Label("Departement :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-10">
                                    @Html.Label((String)@ViewBag.Dept, new { })
                                </div>
                            </div>
                            }
                            else
                            { 
                            <div class="form-group">
                                @Html.Label("Departement :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-10">
                                    @Html.Label("-", new { @class = "col-md-2 control-label" })
                                </div>
                            </div>
                            }
                            @if (@ViewBag.post != null)
                            {
                                 <div class="form-group">
                                @Html.Label("Position :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-10">
                                    @Html.Label((String)@ViewBag.post, new { })
                                </div>
                            </div>
                            }
                            else
                            { 
                            <div class="form-group">
                                @Html.Label("Position :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-10">
                                    @Html.Label("-", new { })
                                </div>
                            </div>
                            }
                            <div class="form-group">
                                @Html.Label("Start / End Date :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-10">
                                    @Html.Label("-", new { @class = "col-md-2 control-label" })
                                </div>
                            </div>
                            <div class="form-group" style="margin-bottom:20px">
                                @Html.Label("Reason :", new { @class = "col-md-2 control-label" })
                                <div class="col-lg-10">
                                    @Html.TextArea("pivchReason", new { @class = "form-control" })
                                </div>
                            </div>
                        </form>
                     
                    </div>
                </div>
                <div>
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <input type="Submit" value="Process" class="btn btn-default" id="buttonSubmit" name="command" />
                                    <input type="button" value="Back" class="btn btn-default" id="buttonBack" onclick="window.location.href='@Url.Action("AddUserRequest", "AccessAndUserIDRequest", new {  })'" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
}

<div class="modal" id="myModal">
    <div class="model fadeIn" id="modalId" tabindex="-1">
        <div class="modal-dialog" style="width:auto">
            <div class="modal-content">
                <div class="modal-header" >
                    <a class="close" data-dismiss="modal">×</a>
                    <h3>NIK Search Prompt</h3>
                </div>
                <div >
                  
                        <div class="col-lg-10" >
                            @Html.Label("SearchBy", new { @class = "col-md-2 control-label" })

                            <div class="col-lg-5">
                                @Html.DropDownList("ParamField", (IEnumerable<SelectListItem>)ViewBag.menuNIK, "All", new { @class = "form-control" })

                            </div>

                            <div class="col-lg-5">
                                @Html.TextBox("SearchValue", null, new { @class = "form-control" })

                            </div>

                        </div>
                    <div class="modal-footer">
                        <input type="Submit" value="Search" class="btn btn-default" id="buttonSearch" />

                        <script type="text/javascript">
                            $(window).bind('resize', function () {
                                jQuery("#grid").setGridWidth($('.modal-footer').width(), true);
                            }).trigger('resize');

                            $('#buttonSearch').click(function () {
                                $("#grid").jqGrid({
                                    url: '@Url.Action("GetHRCurrentJobEmployee", "AccessAndUserIDRequest")',
                                    datatype: "JSON",
                                    mtype: "POST",

                                    postData: {

                                        ParamField: (function () {
                                            return $("#ParamField option:selected").val();
                                        }),
                                        SearchValue: (function () {
                                            return $("#SearchValue").val();
                                        })

                                    },
                                    colNames: ['NIK', 'Employee Name', 'Branch', 'Departement', 'Position', 'Job Employee Id', 'Action'],
                                    colModel: [
                                        { key: true, Name: true, name: 'NIK', editable: true, width: 100 },
                                        { key: false, name: 'EmployeeName', editable: true },
                                        { key: false, name: 'BranchName', editable: true, width: 100 },
                                        { key: false, name: 'DepartementName', editable: true, width: 110 },
                                        { key: false, name: 'PrivilegeName', editable: true, width: 150 },
                                        { key: false, name: 'JobEmployeeId', hidden: true, width: 150 },
                                        {
                                            name: 'Pick NIK', title: false,
                                            formatter: function (cellvalue, options, rowObject) {
                                                return '<a href="/HR/AccessAndUserIDRequest/NewAccessUserIDRequest?value=' + rowObject.NIK + '&JobId=' + rowObject.JobEmployeeId + '">' +
                                                "Detail" + "</a>";
                                            }
                                        }
                                    ],

                                    pager: '#pager',
                                    rowNum: 10,
                                    rowList: [10, 20, 30, 40],
                                    height: '80%',
                                    width: '50%',

                                    caption: 'User Request',
                                    emptyrecords: 'No records to display',

                                    jsonReader: {
                                        root: "rows",
                                        page: "page",
                                        total: "total",
                                        records: "records",
                                        repeatitems: false,
                                        cell: "cell",
                                        id: "id",
                                        userdata: "userdata",
                                    },

                                    multiselect: false,
                                });
                                $("#grid").trigger("reloadGrid", [{ page: 1 }]);

                            });
                        </script>

                        <div class="panel-body" style="align-content:center">
                            <div id="divTable">
                                <table id="grid"></table>
                                <div id="pager"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
 </div>
